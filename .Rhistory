###
gls.mam.1.exp <- gls(fdis_mammals ~ rich_mammals + Productivity + climate_mammals + dr_mammals + aa_mammals + Elevation, data=sem_dataset,correlation = spaceLin)
gls.mam.2.exp <- gls(rich_mammals ~ climate_mammals + Productivity + dr_mammals + aa_mammals + Elevation, data=sem_dataset, correlation = spaceSpher)
gls.mam.3.exp <- gls(aa_mammals ~ climate_mammals + Productivity + Elevation,data = sem_dataset, correlation = spaceExp)
gls.mam.4.exp <- gls(dr_mammals ~ climate_mammals + Productivity + Elevation, data = sem_dataset, correlation = spaceLin)
mammals.psem <- psem(gls.mam.1.exp, gls.mam.2.exp, gls.mam.3.exp, gls.mam.4.exp)
summary(mammals.psem)
sem_dataset <- copy
gls.mam.1.exp <- gls(fdis_mammals ~ rich_mammals + Productivity + climate_mammals + dr_mammals + aa_mammals + Elevation, data=sem_dataset,correlation = spaceLin)
gls.mam.2.exp <- gls(rich_mammals ~ climate_mammals + Productivity + dr_mammals + aa_mammals + Elevation, data=sem_dataset, correlation = spaceSpher)
gls.mam.3.exp <- gls(aa_mammals ~ climate_mammals + Productivity + Elevation,data = sem_dataset, correlation = spaceExp)
gls.mam.4.exp <- gls(dr_mammals ~ climate_mammals + Productivity + Elevation, data = sem_dataset, correlation = spaceLin)
gls.mam.4.exp <- gls(dr_mammals ~ climate_mammals + Productivity + Elevation, data = sem_dataset, correlation = spaceLin)
mammals.psem <- psem(gls.mam.1.exp, gls.mam.2.exp, gls.mam.3.exp, gls.mam.4.exp)
summary(mammals.psem)
full_data <- read.table("dataset_metrics.txt")
abiotic_data <- read.table("abiotic_data.txt")
# shapefile data
grid_ma <- readOGR("gridmacro.shp") #432 grids
grid_center <- coordinates(grid_ma) # obtain center of grid
grid_ma <- st_as_sf(grid_ma) # convert to sf object
grid_ma <- st_set_crs(grid_ma, 4326) # convert to WGS84
cor.spatial(data_analysis$fdis_birds, data_analysis$fdis_squa, grid_center)
# preparing data
data_analysis <- left_join(grid_ma, full_data, by = "id")
cor.spatial(data_analysis$fdis_birds, data_analysis$fdis_mammals, grid_center)
cor.spatial(data_analysis$fdis_birds, data_analysis$fdis_squa, grid_center)
cor.spatial(data_analysis$fdis_birds,data_analysis$fdis_amp,grid_center)
cor.spatial(data_analysis$fdis_mammals,data_analysis$fdis_squa,grid_center)
cor.spatial(data_analysis$fdis_mammals,data_analysis$fdis_amp,grid_center)
cor.spatial(data_analysis$fdis_squa,data_analysis$fdis_amp,grid_center)
cor.spatial(data_analysis$rich_birds, data_analysis$rich_mammals, grid_center)
cor.spatial(data_analysis$rich_birds, data_analysis$rich_squa, grid_center)
cor.spatial(data_analysis$rich_birds,data_analysis$rich_amp,grid_center)
cor.spatial(data_analysis$rich_mammals,data_analysis$rich_squa,grid_center)
cor.spatial(data_analysis$rich_mammals,data_analysis$rich_amp,grid_center)
cor.spatial(data_analysis$rich_squa,data_analysis$rich_amp,grid_center)
cor.spatial(data_analysis$dr_birds, data_analysis$dr_mammals, grid_center)
cor.spatial(data_analysis$dr_birds, data_analysis$dr_squa, grid_center)
cor.spatial(data_analysis$dr_birds,data_analysis$dr_amp,grid_center)
cor.spatial(data_analysis$dr_mammals,data_analysis$dr_squa,grid_center)
cor.spatial(data_analysis$dr_mammals,data_analysis$dr_amp,grid_center)
cor.spatial(data_analysis$dr_squa,data_analysis$dr_amp,grid_center)
cor.spatial(data_analysis$aa_birds, data_analysis$aa_mammals, grid_center)
cor.spatial(data_analysis$aa_birds, data_analysis$aa_squa, grid_center)
cor.spatial(data_analysis$aa_birds,data_analysis$aa_amp,grid_center)
cor.spatial(data_analysis$aa_mammals,data_analysis$aa_squa,grid_center)
cor.spatial(data_analysis$aa_mammals,data_analysis$aa_amp,grid_center)
cor.spatial(data_analysis$aa_squa,data_analysis$aa_amp,grid_center)
cor.test(data_analysis$aa_birds, data_analysis$aa_mammals, alternative="two-sided", method = "pearson")
cor.test(data_analysis$aa_birds, data_analysis$aa_mammals, alternative="two.sided", method = "pearson")
# Preparing dataset
data_full <- left_join(full_data,abiotic_data, by="id")
# Construímos um modelo linear das variáveis que serão preditas pelo clima
# amp
ml_amp <- lm(rich_amp + dr_amp + aa_amp + fdis_amp ~ BIO01+ BIO02+BIO03+BIO04+BIO07+BIO11+BIO12+BIO15+BIO17, data=data_full)
# squa
ml_squa <- lm(rich_squa + dr_squa + aa_squa + fdis_squa ~ BIO01+ BIO02+BIO03+BIO04+BIO07+BIO11+BIO12+BIO15+BIO17, data=data_full)
# birds
ml_birds <- lm(rich_birds + dr_birds + aa_birds + fdis_birds ~ BIO01+ BIO02+BIO03+BIO04+BIO07+BIO11+BIO12+BIO15+BIO17, data=data_full)
# mammals
ml_mammals <- lm(rich_mammals + dr_mammals + aa_mammals + fdis_mammals ~ BIO01+ BIO02+BIO03+BIO04+BIO07+BIO11+BIO12+BIO15+BIO17, data=data_full)
#create vector of VIF values
vif_amp <- vif(ml_amp)
vif_squa <- vif(ml_squa)
vif_birds <- vif(ml_birds)
vif_mammals <- vif(ml_mammals)
# vif are equal for all groups
#create horizontal bar chart to display each VIF value
barplot(vif_amp, main = "VIF Values", horiz = TRUE, col = "steelblue")+abline(v = 20)
barplot(vif_squa, main = "VIF Values", horiz = TRUE, col = "steelblue")+abline(v = 20)
barplot(vif_birds, main = "VIF Values", horiz = TRUE, col = "steelblue")+abline(v = 20)
barplot(vif_mammals, main = "VIF Values", horiz = TRUE, col = "steelblue")+abline(v = 20)
#Model without bio01 e bio11
ml2_amp <- lm(rich_amp + dr_amp + aa_amp + fdis_amp ~ BIO03+BIO04+BIO12+BIO15+BIO17, data=data_full)
ml2_squa <- lm(rich_squa + dr_squa + aa_squa + fdis_squa ~ BIO03+BIO04+BIO12+BIO15+BIO17, data=data_full)
ml2_birds <- lm(rich_birds + dr_birds + aa_birds + fdis_birds ~ BIO03+BIO04+BIO12+BIO15+BIO17, data=data_full)
ml2_mammals <- lm(rich_mammals + dr_mammals + aa_mammals + fdis_mammals ~ BIO03+BIO04+BIO12+BIO15+BIO17, data=data_full)
# Verificando multicolinearidade - VIF
#create vector of VIF values
vif(ml2_amp)
vif(ml2_squa)
vif(ml2_birds)
vif(ml2_mammals)
#create horizontal bar chart to display each VIF value
barplot(vif(ml2_mammals), main = "VIF Values", horiz = TRUE, col = "steelblue")+abline(v = 20)
# amphibia composite climate
rich_03_amp <- summary(ml2_amp)$coefficients[2, 1]
rich_04_amp <-  summary(ml2_amp)$coefficients[3, 1]
rich_12_amp <-  summary(ml2_amp)$coefficients[4, 1]
rich_15_amp <-  summary(ml2_amp)$coefficients[5, 1]
rich_17_amp <-  summary(ml2_amp)$coefficients[6, 1]
# squamata composite
rich_03_squa <- summary(ml2_squa)$coefficients[2, 1]
rich_04_squa <-  summary(ml2_squa)$coefficients[3, 1]
rich_12_squa <-  summary(ml2_squa)$coefficients[4, 1]
rich_15_squa <-  summary(ml2_squa)$coefficients[5, 1]
rich_17_squa <-  summary(ml2_squa)$coefficients[6, 1]
# birds composite
rich_03_birds <- summary(ml2_birds)$coefficients[2, 1]
rich_04_birds <-  summary(ml2_birds)$coefficients[3, 1]
rich_12_birds <-  summary(ml2_birds)$coefficients[4, 1]
rich_15_birds <-  summary(ml2_birds)$coefficients[5, 1]
rich_17_birds <-  summary(ml2_birds)$coefficients[6, 1]
# mammals composite
rich_03_mammals <- summary(ml2_mammals)$coefficients[2, 1]
rich_04_mammals <-  summary(ml2_mammals)$coefficients[3, 1]
rich_12_mammals <-  summary(ml2_mammals)$coefficients[4, 1]
rich_15_mammals <-  summary(ml2_mammals)$coefficients[5, 1]
rich_17_mammals <-  summary(ml2_mammals)$coefficients[6, 1]
# Os dados de cada indicador são multiplicados por sua carga e somados para gerar as pontuações dos fatores para a variável composta, que é então usada no modelo estrutural.
# Criando
# amphibia climate
climate_amp <- rich_03_amp * data_full$BIO03 + rich_04_amp * data_full$BIO04 + rich_12_amp * data_full$BIO12 + rich_15_amp * data_full$BIO15 + rich_17_amp * data_full$BIO17
# squamata climate
climate_squa <- rich_03_squa * data_full$BIO03 + rich_04_squa * data_full$BIO04 + rich_12_squa * data_full$BIO12 + rich_15_squa * data_full$BIO15 + rich_17_squa * data_full$BIO17
# birds climate
climate_birds <- rich_03_birds * data_full$BIO03 + rich_04_birds * data_full$BIO04 + rich_12_birds * data_full$BIO12 + rich_15_birds * data_full$BIO15 + rich_17_birds * data_full$BIO17
# mammals climate
climate_mammals <- rich_03_mammals * data_full$BIO03 + rich_04_mammals * data_full$BIO04 + rich_12_mammals * data_full$BIO12 + rich_15_mammals * data_full$BIO15 + rich_17_mammals * data_full$BIO17
climate_squa
#Preparing dataset
climate <- cbind(climate_amp, climate_squa, climate_birds, climate_mammals)
climate_data <- data.frame(id=data_full$id, climate)
coords_dataset <- cbind(climate_data, grid_center)
coords_dataset <- coords_dataset %>% rename(V2 = "1", V1 = "2")
# join dataset
sem_dataset <- left_join(data_full, coords_dataset, by="id")
spaceExp <- corExp(form =~ V2+V1, nugget=T)
spaceGaus <- corGaus(form =~ V2+V1, nugget=T)
spaceLin <- corLin(form=~ V2+V1, nugget=T)
spaceRatio <- corRatio(form=~ V2+V1, nugget=T)
spaceSpher <- corSpher(form= ~V2+V1, nugget=T)
coords <- sem_dataset[,33:34] # coords of df
sem_dataset_trans <- sem_dataset # new obj
sem_dataset_trans <- sem_dataset[,-c(1,18:26,33:34)]#new obj
sem_dataset_trans
names(sem_dataset_trans
names(sem_dataset_trans)
# add coordinates again
sem_dataset_trans <-cbind(sem_dataset_trans,coords)
names(sem_dataset_trans)
View(sem_dataset)
# Amphibia
# spaceCor
gls.amp.1.exp <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.2.exp <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.3.exp <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.amp.4.exp <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
#spaceGaus
gls.amp.1.gaus <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.2.gaus <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.3.gaus <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.amp.4.gaus <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
#spaceLin
gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
#spaceLin
#gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
#spaceLin
#gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.3.lin <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.amp.4.lin <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceLin)
gls.amp.1.ratio <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceRatio)
gls.amp.2.ratio <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceRatio)
gls.amp.3.ratio <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.amp.4.ratio <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
#spaceSpher
gls.amp.1.spher <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.2.spher <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.3.spher <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.amp.4.spher <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
# spaceExp
gls.rep.1.exp <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation= corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
# spaceExp
gls.rep.1.exp <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation= spaceExp)
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceExp)
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
00, 0.1), form =~ V2+V1, nugget=T))
gls.rep.3.exp <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.rep.4.exp <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation= corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
# spaceGaus
gls.rep.1.gaus <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceGaus)
gls.rep.2.gaus <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceGaus)
gls.rep.3.gaus <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.rep.4.gaus <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
# spaceLin
gls.rep.1.lin <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceLin)
gls.rep.2.lin <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceLin)
gls.rep.3.lin <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.rep.4.lin <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceLin)
# spaceRatio
gls.rep.1.ratio <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceRatio)
gls.rep.2.ratio <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceRatio)
gls.rep.3.ratio <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.rep.4.ratio <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
# spaceSpher
gls.rep.1.spher <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceSpher)
gls.rep.2.spher <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceSpher)
gls.rep.3.spher <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.rep.4.spher <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
gls.bird.1.exp <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset,  correlation = spaceExp)
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset, correlation = spaceExp)
gls.bird.3.exp <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset, correlation = spaceExp)
gls.bird.4.exp <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset, correlation = spaceExp)
gls.bird.1.gaus <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset, correlation = spaceGaus)
gls.bird.1.exp <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans,  correlation = spaceExp)
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceExp)
gls.bird.3.exp <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.bird.4.exp <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
gls.bird.1.gaus <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceGaus)
gls.bird.2.gaus <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceGaus)
gls.bird.3.gaus <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.bird.4.gaus <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
gls.bird.1.lin <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceLin)
# spaceLin
gls.bird.1.lin <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceLin)
# spaceLin
gls.bird.1.lin <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = corLin(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.lin <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceLin)
gls.bird.3.lin <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.bird.3.lin <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.bird.4.lin <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation =  spaceLin)
gls.bird.4.lin <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation =  spaceLin)
birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation =  spaceLin)
gls.bird.4.lin
gls.bird.1.ratio <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceRatio)
gls.bird.2.ratio <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceRatio)
gls.bird.3.ratio <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.bird.4.ratio <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
gls.bird.1.spher <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceSpher)
gls.bird.2.spher <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceSpher)
gls.bird.3.spher <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.bird.4.spher <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
gls.mam.1.exp <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation = spaceExp)
gls.mam.2.exp <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceExp)
gls.mam.3.exp <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.mam.4.exp <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
gls.mam.1.gaus <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=spaceGaus)
gls.mam.2.gaus <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceGaus)
gls.mam.3.gaus <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.mam.4.gaus <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
gls.mam.1.lin <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation= spaceLin)
# spaceLin
gls.mam.1.lin <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation= corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.2.lin <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceLin)
gls.mam.2.lin <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceLin)
gls.mam.3.lin <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.mam.4.lin <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceLin)
gls.mam.4.lin <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.4.lin <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
# spaceRatio
gls.mam.1.ratio <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=spaceRatio)
gls.mam.2.ratio <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceRatio)
gls.mam.3.ratio <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.mam.4.ratio <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
gls.mam.1.spher <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=spaceSpher)
gls.mam.2.spher <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceSpher)
gls.mam.3.spher <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.mam.4.spher <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
gls.mam.4.spher <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corSpher(c(200, 0.1), form =~ V2+V1, nugget=T))
AIC(gls.amp.1.exp, gls.amp.1.gaus, gls.amp.1.ratio, gls.amp.1.spher)
gls.amp.1.exp
sem_dataset_trans
# new object
sem_dataset_trans <- sem_dataset[,-c(1,18:26,33:34)]
sem_dataset_trans <- decostand(sem_dataset_trans, "normalize")
sem_dataset_trans
sem_dataset_trans
# add coordinates again
sem_dataset_trans <-cbind(sem_dataset_trans,coords)
sem_dataset_trans
# Amphibia
# spaceCor
gls.amp.1.exp <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.2.exp <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.3.exp <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.amp.4.exp <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
#spaceGaus
gls.amp.1.gaus <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.2.gaus <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.3.gaus <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.amp.4.gaus <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
#spaceLin
gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.3.lin <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.amp.4.lin <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceLin)
#spaceRatio
gls.amp.1.ratio <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceRatio)
gls.amp.2.ratio <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceRatio)
gls.amp.3.ratio <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.amp.4.ratio <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
#spaceSpher
gls.amp.1.spher <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.2.spher <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.3.spher <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.amp.4.spher <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
gls.rep.1.exp <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation= spaceExp)
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceExp)
sem_dataset_trans
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.3.exp <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.rep.4.exp <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation= corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
# spaceGaus
gls.rep.1.gaus <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceGaus)
gls.rep.2.gaus <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceGaus)
gls.rep.3.gaus <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.rep.4.gaus <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
# spaceLin
gls.rep.1.lin <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceLin)
gls.rep.2.lin <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceLin)
gls.rep.3.lin <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.rep.4.lin <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceLin)
gls.rep.4.lin <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.4.lin <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
# spaceRatio
gls.rep.1.ratio <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceRatio)
gls.rep.2.ratio <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceRatio)
gls.rep.3.ratio <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.rep.4.ratio <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
# spaceSpher
gls.rep.1.spher <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceSpher)
gls.rep.2.spher <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceSpher)
gls.rep.3.spher <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.rep.4.spher <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
# spaceExp
gls.bird.1.exp <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans,  correlation = spaceExp)
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceExp)
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corExp(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corExp(c(800, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.exp <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.bird.4.exp <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
gls.bird.4.exp <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = corExp(c(800, 0.1), form =~ V2+V1, nugget=T))
gls.bird.1.gaus <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceGaus)
gls.bird.2.gaus <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceGaus)
gls.bird.3.gaus <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.bird.4.gaus <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
gls.bird.1.lin <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = corLin(c(500, 0.1), form =~ V2+V1, nugget=T))
# spaceLin
gls.bird.1.lin <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = corLin(c(800, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.lin <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corLin(c(800, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.lin <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.bird.4.lin <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation =  spaceLin)
gls.bird.1.ratio <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceRatio)
gls.bird.2.ratio <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceRatio)
gls.bird.3.ratio <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.bird.4.ratio <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
gls.bird.1.spher <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceSpher)
gls.bird.2.spher <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceSpher)
gls.bird.2.spher <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corSpher(c(800, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.spher <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corSpher(c(800, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.spher <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.bird.4.spher <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
# spaceExp
gls.mam.1.exp <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation = spaceExp)
gls.mam.2.exp <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceExp)
gls.mam.3.exp <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.mam.4.exp <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
# spaceGaus
gls.mam.1.gaus <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=spaceGaus)
gls.mam.2.gaus <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceGaus)
gls.mam.3.gaus <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.mam.4.gaus <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
# spaceLin
gls.mam.1.lin <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation= corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
# spaceLin
gls.mam.1.lin <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation= spaceLin)
gls.mam.2.lin <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceLin)
gls.mam.2.lin <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceLin)
gls.mam.3.lin <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.mam.4.lin <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.1.ratio <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=spaceRatio)
gls.mam.2.ratio <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceRatio)
gls.mam.3.ratio <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.mam.4.ratio <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
gls.mam.1.spher <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=spaceSpher)
gls.mam.2.spher <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceSpher)
gls.mam.3.spher <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.mam.4.spher <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corSpher(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.4.spher <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
AIC(gls.amp.1.exp, gls.amp.1.gaus,gls.amp.1.lin, gls.amp.1.ratio, gls.amp.1.spher)
AIC(gls.amp.2.exp, gls.amp.2.gaus, gls.amp.2.ratio, gls.amp.2.spher, gls.amp.2.lin)
AIC(gls.amp.3.exp, gls.amp.3.gaus, gls.amp.3.lin , gls.amp.3.ratio, gls.amp.3.spher)
AIC(gls.amp.4.exp, gls.amp.4.gaus, gls.amp.4.ratio, gls.amp.4.spher, gls.amp.4.lin)
AIC(gls.amp.1.exp, gls.amp.1.gaus,gls.amp.1.lin, gls.amp.1.ratio, gls.amp.1.spher)
AIC(gls.amp.1.exp, gls.amp.1.gaus,gls.amp.1.lin, gls.amp.1.ratio, gls.amp.1.spher)
AIC(gls.amp.2.exp, gls.amp.2.gaus, gls.amp.2.ratio, gls.amp.2.spher, gls.amp.2.lin)
AIC(gls.amp.3.exp, gls.amp.3.gaus, gls.amp.3.lin , gls.amp.3.ratio, gls.amp.3.spher)
AIC(gls.amp.4.exp, gls.amp.4.gaus, gls.amp.4.ratio, gls.amp.4.spher, gls.amp.4.lin)
#diagnosis
amp1 <- plot(gls.amp.1.exp, main="gls.amp.1.spher")
amp2 <- plot(gls.amp.2.ratio, main="gls.amp.2.ratio")
amp3 <- plot(gls.amp.3.exp, main="gls.amp.3.exp")
amp4 <- plot(gls.amp.4.spher, main="gls.amp.4.exp")
#plot
plot_grid(amp1,amp2,amp3,amp4, align = "h", rel_widths = c(1, 1),labels = NULL)
plot_grid(amp1,amp2,amp3,amp4, align = "h", rel_widths = c(1, 1),labels = NULL)
#diagnosis
amp1 <- plot(gls.amp.1.exp, main="gls.amp.1.spher")
amp2 <- plot(gls.amp.2.ratio, main="gls.amp.2.ratio")
amp3 <- plot(gls.amp.3.exp, main="gls.amp.3.exp")
amp4 <- plot(gls.amp.4.spher, main="gls.amp.4.spher")
#plot
plot_grid(amp1,amp2,amp3,amp4, align = "h", rel_widths = c(1, 1),labels = NULL)
plot_grid(amp1,amp2,amp3,amp4, align = "h", rel_widths = c(1, 1),labels = NULL)
#diagnosis
amp1 <- plot(gls.amp.1.exp, main="gls.amp.1.exp")
amp2 <- plot(gls.amp.2.ratio, main="gls.amp.2.ratio")
amp3 <- plot(gls.amp.3.exp, main="gls.amp.3.exp")
amp4 <- plot(gls.amp.4.spher, main="gls.amp.4.spher")
#plot
plot_grid(amp1,amp2,amp3,amp4, align = "h", rel_widths = c(1, 1),labels = NULL)
plot_grid(amp1,amp2,amp3,amp4, align = "h", rel_widths = c(1, 1),labels = NULL)
# amphibia
anura.psem <- psem(gls.amp.1.exp, gls.amp.2.ratio, gls.amp.3.exp, gls.amp.4.spher)
summary(anura.psem)
resid.anura <- residuals(anura.psem)
AIC(gls.rep.1.exp, gls.rep.1.gaus, gls.rep.1.lin, gls.rep.1.ratio, gls.rep.1.spher)
AIC(gls.rep.2.exp, gls.rep.2.ratio, gls.rep.2.gaus, gls.rep.2.lin, gls.rep.2.spher)
AIC(gls.rep.3.exp, gls.rep.3.gaus, gls.rep.3.lin, gls.rep.3.ratio, gls.rep.3.spher)
AIC(gls.rep.4.gaus, gls.rep.4.lin, gls.rep.4.ratio, gls.rep.4.spher,  gls.rep.4.exp)
rep1 <- plot(gls.rep.1.spher, main="gls.rep.1.spher")
rep2 <- plot(gls.rep.2.ratio, main="gls.rep.2.ratio")
rep3 <- plot(gls.rep.3.ratio, main="gls.rep.3.ratio")
rep4 <- plot(gls.rep.4.ratio, main="gls.rep.4.ratio")
plot_grid(rep1,rep2,rep3,rep4, align = "h", rel_widths = c(1, 1),labels = NULL)
#Squamata
reptilia.psem <- psem(gls.rep.1.spher, gls.rep.2.ratio, gls.rep.3.ratio, gls.rep.4.ratio)
summary(reptilia.psem)
#summary(reptilia.psem)
resid.rep <- residuals(reptilia.psem)
AIC(gls.bird.1.gaus, gls.bird.1.lin, gls.bird.1.ratio, gls.bird.1.spher, gls.bird.1.exp)
AIC(gls.bird.2.exp, gls.bird.2.gaus, gls.bird.2.ratio, gls.bird.2.spher)
AIC(gls.bird.2.exp, gls.bird.2.gaus, gls.bird.2.ratio, gls.bird.2.spher, gls.bird.2.lin) #gls.bird.2.ratio
AIC(gls.bird.2.exp, gls.bird.2.gaus, gls.bird.2.ratio, gls.bird.2.spher, gls.bird.2.lin)
gls.bird.2.lin
gls.bird.2.exp
AIC(gls.bird.3.exp, gls.bird.3.gaus, gls.bird.3.ratio, gls.bird.3.spher, gls.bird.3.lin)
AIC(gls.bird.4.exp,gls.bird.4.gaus, gls.bird.4.lin, gls.bird.4.ratio, gls.bird.4.spher)
# squamata gls diagnosis
bird1 <- plot(gls.bird.1.ratio, main="gls.bird.1.ratio")
bird2 <- plot(gls.bird.2.exp, main="gls.bird.2.exp")
bird3 <- plot(gls.bird.3.exp, main="gls.bird.3.exp")
bird4 <- plot(gls.bird.4.ratio, main="gls.bird.4.ratio")
# combinacao
plot_grid(bird1,bird2,bird3,bird4, align = "h", rel_widths = c(1, 1),labels = NULL)
plot_grid(bird1,bird2,bird3,bird4, align = "h", rel_widths = c(1, 1),labels = NULL)
#Birds
birds.psem <- psem(gls.bird.1.ratio, gls.bird.2.exp, gls.bird.3.exp, gls.bird.4.ratio)
summary(birds.psem)
AIC(gls.mam.1.exp, gls.mam.1.gaus, gls.mam.1.lin, gls.mam.1.ratio, gls.mam.1.spher)
AIC(gls.mam.2.exp, gls.mam.2.gaus, gls.mam.2.lin, gls.mam.2.ratio, gls.mam.2.spher)
AIC(gls.mam.3.exp, gls.mam.3.gaus, gls.mam.3.lin, gls.mam.3.ratio, gls.mam.3.spher)
AIC(gls.mam.4.exp, gls.mam.4.gaus, gls.mam.4.lin, gls.mam.4.ratio, gls.mam.4.spher)
#Diagnose mammals
mam1 <- plot(gls.mam.1.spher, main="gls.mam.1.spher")
mam2 <- plot(gls.mam.2.spher, main="gls.mam.2.spher")
mam4 <- plot(gls.mam.4.exp, main="gls.mam.4.exp")
plot_grid(mam1,mam2,mam3,mam4, align = "h", rel_widths = c(1, 1),labels = NULL)
mam3 <- plot(gls.mam.3.gaus, main="gls.mam.3.gaus")
plot_grid(mam1,mam2,mam3,mam4, align = "h", rel_widths = c(1, 1),labels = NULL)
#Mammals
mammals.psem <- psem(gls.mam.1.spher, gls.mam.2.spher, gls.mam.3.gaus, gls.mam.4.exp)
summary(mammals.psem)
#summary(mammals.psem)
resid.mammals <- residuals(mammals.psem)
#summary(birds.psem)
resid.birds <- residuals(birds.psem)
#summary(reptilia.psem)
resid.rep <- residuals(reptilia.psem)
resid.anura <- residuals(anura.psem)
# Spatial autocorrelation in predictors variables
distan <- lets.distmat(sem_dataset[, 33:34])
#Anfíbios
par(mfrow=c(2,2))
moran.amp <- lets.correl(resid.anura, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Repteis
moran.rep <- lets.correl(resid.rep, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Aves
moran.birds <- lets.correl(resid.birds, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Mammals
moran.mammals <- lets.correl(resid.mammals, distan, 12,
equidistant = FALSE,
plot = TRUE)
par(mfrow=c(2,2))
moran.amp <- lets.correl(resid.anura, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Repteis
moran.rep <- lets.correl(resid.rep, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Aves
moran.birds <- lets.correl(resid.birds, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Mammals
moran.mammals <- lets.correl(resid.mammals, distan, 12,
equidistant = FALSE,
plot = TRUE)
