gls.amp.1.spher <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.2.spher <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.3.spher <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.amp.4.spher <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
# spaceExp
gls.rep.1.exp <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation= spaceExp)
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.3.exp <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.rep.4.exp <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation= corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
# spaceGaus
gls.rep.1.gaus <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceGaus)
gls.rep.2.gaus <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceGaus)
gls.rep.3.gaus <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.rep.4.gaus <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
# spaceLin
gls.rep.1.lin <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceLin)
gls.rep.2.lin <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceLin)
gls.rep.3.lin <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.rep.3.lin <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.3.lin <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.4.lin <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
# spaceRatio
gls.rep.1.ratio <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceRatio)
gls.rep.2.ratio <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceRatio)
gls.rep.3.ratio <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.rep.4.ratio <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
# spaceSpher
gls.rep.1.spher <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceSpher)
gls.rep.2.spher <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceSpher)
gls.rep.3.spher <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.rep.4.spher <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
# spaceExp
gls.bird.1.exp <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans,  correlation = spaceExp)
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corExp(c(800, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corExp(c(900, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corExp(c(1000, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.exp <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.bird.3.exp <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.exp <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.4.exp <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = corExp(c(800, 0.1), form =~ V2+V1, nugget=T))
gls.bird.1.gaus <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceGaus)
gls.bird.2.gaus <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceGaus)
gls.bird.3.gaus <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.bird.4.gaus <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
# spaceLin
gls.bird.1.lin <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = corLin(c(800, 0.1), form =~ V2+V1, nugget=T))
# spaceLin
gls.bird.1.lin <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.lin <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.lin <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.bird.3.lin <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.bird.4.lin <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation =  spaceLin)
# spaceRatio
gls.bird.1.ratio <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceRatio)
gls.bird.2.ratio <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceRatio)
gls.bird.3.ratio <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.bird.4.ratio <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
# spaceSpher
gls.bird.1.spher <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceSpher)
gls.bird.2.spher <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corSpher(c(800, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.spher <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.bird.4.spher <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
# spaceExp
gls.mam.1.exp <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation = spaceExp)
# spaceExp
gls.mam.1.exp <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.mam.2.exp <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceExp)
gls.mam.3.exp <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.mam.4.exp <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
gls.mam.4.exp <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
# spaceGaus
gls.mam.1.gaus <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=spaceGaus)
gls.mam.2.gaus <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceGaus)
gls.mam.3.gaus <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.mam.4.gaus <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
# spaceLin
gls.mam.1.lin <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation= spaceLin)
gls.mam.2.lin <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceLin)
gls.mam.3.lin <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.mam.4.lin <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
# spaceRatio
gls.mam.1.ratio <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=spaceRatio)
gls.mam.2.ratio <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceRatio)
gls.mam.3.ratio <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.mam.4.ratio <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
# spaceSpher
gls.mam.1.spher <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=spaceSpher)
gls.mam.2.spher <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceSpher)
gls.mam.3.spher <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.mam.4.spher <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
AIC(gls.amp.1.exp, gls.amp.1.gaus,gls.amp.1.lin, gls.amp.1.ratio, gls.amp.1.spher)
AIC(gls.amp.2.exp, gls.amp.2.gaus, gls.amp.2.ratio, gls.amp.2.spher, gls.amp.2.lin)
AIC(gls.amp.3.exp, gls.amp.3.gaus, gls.amp.3.lin , gls.amp.3.ratio, gls.amp.3.spher)
AIC(gls.amp.4.exp, gls.amp.4.gaus, gls.amp.4.ratio, gls.amp.4.spher, gls.amp.4.lin)
anura.psem <- psem(gls.amp.1.exp, gls.amp.2.ratio, gls.amp.3.exp, gls.amp.4.spher)
summary(anura.psem)
sem_dataset_trans
View(sem_dataset_trans)
anura.psem <- psem(gls.amp.1.exp, gls.amp.2.ratio, gls.amp.3.exp, gls.amp.4.spher)
summary(anura.psem)
AIC(gls.rep.1.exp, gls.rep.1.gaus, gls.rep.1.lin, gls.rep.1.ratio, gls.rep.1.spher)
AIC(gls.rep.2.exp, gls.rep.2.ratio, gls.rep.2.gaus, gls.rep.2.lin, gls.rep.2.spher)
AIC(gls.rep.3.exp, gls.rep.3.gaus, gls.rep.3.lin, gls.rep.3.ratio, gls.rep.3.spher)
AIC(gls.rep.4.gaus, gls.rep.4.lin, gls.rep.4.ratio, gls.rep.4.spher,  gls.rep.4.exp)
reptilia.psem <- psem(gls.rep.1.spher, gls.rep.2.ratio, gls.rep.3.ratio, gls.rep.4.spher)
summary(reptilia.psem)
AIC(gls.bird.1.gaus, gls.bird.1.lin, gls.bird.1.ratio, gls.bird.1.spher, gls.bird.1.exp)
AIC(gls.bird.2.exp, gls.bird.2.gaus, gls.bird.2.ratio, gls.bird.2.spher, gls.bird.2.lin)
AIC(gls.bird.3.exp, gls.bird.3.gaus, gls.bird.3.ratio, gls.bird.3.spher, gls.bird.3.lin)
AIC(gls.bird.4.exp,gls.bird.4.gaus, gls.bird.4.lin, gls.bird.4.ratio, gls.bird.4.spher)
#Birds
birds.psem <- psem(gls.bird.1.ratio, gls.bird.2.ratio, gls.bird.3.exp, gls.bird.4.exp)
summary(birds.psem)
AIC(gls.mam.1.exp, gls.mam.1.gaus, gls.mam.1.lin, gls.mam.1.ratio, gls.mam.1.spher)
AIC(gls.mam.2.exp, gls.mam.2.gaus, gls.mam.2.lin, gls.mam.2.ratio, gls.mam.2.spher)
AIC(gls.mam.3.exp, gls.mam.3.gaus, gls.mam.3.lin, gls.mam.3.ratio, gls.mam.3.spher)
AIC(gls.mam.4.exp, gls.mam.4.gaus, gls.mam.4.lin, gls.mam.4.ratio, gls.mam.4.spher)
#Mammals
mammals.psem <- psem(gls.mam.1.exp, gls.mam.2.spher, gls.mam.3.spher, gls.mam.4.exp)
summary(mammals.psem)
resid.anura <- residuals(anura.psem)
resid.rep <- residuals(reptilia.psem)
resid.birds <- residuals(birds.psem)
resid.mammals <- residuals(mammals.psem)
View(sem_dataset)
distan <- lets.distmat(sem_dataset[, 33:34])
#Anfíbios
par(mfrow=c(2,2))
moran.amp <- lets.correl(resid.anura, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Repteis
moran.rep <- lets.correl(resid.rep, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Aves
moran.birds <- lets.correl(resid.birds, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Mammals
moran.mammals <- lets.correl(resid.mammals, distan, 12,
equidistant = FALSE,
plot = TRUE)
sem_dataset
View(sem_dataset)
coords <- sem_dataset[,33:34] # coordinates of df
# new object
sem_dataset_trans <- sem_dataset[,-c(1,18:26,33:34)]
sem_dataset_trans <- decostand(sem_dataset_trans, "normalize")
coords <- sem_dataset[,33:34] # coordinates of df
# new object
sem_dataset_trans <- sem_dataset[,-c(1,18:26,33:34)]
View(sem_dataset_trans)
sem_dataset_trans
sem_dataset_trans <- decostand(sem_dataset_trans, "normalize")
sem_dataset_trans
View(sem_dataset_trans )
# add coordinates again
sem_dataset_trans <-cbind(sem_dataset_trans,coords)
# Amphibia
# spaceCor
gls.amp.1.exp <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
# new object
sem_dataset_trans <- sem_dataset[,-c(1,18:26,33:34)]
sem_dataset_trans <- decostand(sem_dataset_trans, "standardize")
# add coordinates again
sem_dataset_trans <-cbind(sem_dataset_trans,coords)
# Amphibia
# spaceCor
gls.amp.1.exp <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.2.exp <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.3.exp <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.amp.3.exp <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.amp.4.exp <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
gls.amp.3.exp <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.amp.4.exp <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
gls.amp.2.exp <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.2.exp <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
#spaceGaus
gls.amp.1.gaus <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.2.gaus <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.3.gaus <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.amp.4.gaus <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
#spaceLin
gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
# amphibia
anura.psem <- psem(gls.amp.1.exp, gls.amp.2.exp, gls.amp.3.exp, gls.amp.4.exp)
summary(anura.psem)
summary(anura.psem)
gls.amp.1.exp <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.2.exp <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.3.exp <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.amp.4.exp <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
gls.amp.2.exp <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
anura.psem <- psem(gls.amp.1.exp, gls.amp.2.ratio, gls.amp.3.exp, gls.amp.4.spher)
summary(anura.psem)
gls.amp.1.gaus <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.2.gaus <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.3.gaus <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.amp.4.gaus <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
gls.amp.1.ratio <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceRatio)
gls.amp.2.ratio <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceRatio)
gls.amp.3.ratio <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.amp.4.ratio <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
gls.amp.1.spher <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.2.spher <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.3.spher <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.amp.4.spher <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
#spaceLin
gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
#spaceLin
gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans,correlation = corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
#spaceLin
gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans,correlation = corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.amp.3.lin <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.amp.4.lin <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
# Anfíbios
AIC(gls.amp.1.exp, gls.amp.1.gaus,gls.amp.1.lin, gls.amp.1.ratio, gls.amp.1.spher) #gls.amp.1.exp
AIC(gls.amp.2.exp, gls.amp.2.gaus, gls.amp.2.ratio, gls.amp.2.spher, gls.amp.2.lin)
AIC(gls.amp.3.exp, gls.amp.3.gaus, gls.amp.3.lin , gls.amp.3.ratio, gls.amp.3.spher)
AIC(gls.amp.4.exp, gls.amp.4.gaus, gls.amp.4.ratio, gls.amp.4.spher, gls.amp.4.lin)
# amphibia
anura.psem <- psem(gls.amp.1.spher, gls.amp.2.ratio, gls.amp.3.exp, gls.amp.4.spher)
summary(anura.psem)
coords <- sem_dataset[,33:34] # coordinates of df
# new object
sem_dataset_trans <- sem_dataset[,-c(1,18:26,33:34)]
sem_dataset_trans <- decostand(sem_dataset_trans, "normalize")
# add coordinates again
sem_dataset_trans <-cbind(sem_dataset_trans,coords)
# Amphibia
# spaceCor
gls.amp.1.exp <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.2.exp <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceExp)
gls.amp.3.exp <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.amp.4.exp <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
#spaceGaus
gls.amp.1.gaus <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.2.gaus <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceGaus)
gls.amp.3.gaus <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.amp.4.gaus <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
#spaceLin
gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans,correlation = corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
#spaceLin
gls.amp.1.lin <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans,correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = correlation = spaceLin)
gls.amp.2.lin <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceLin)
gls.amp.3.lin <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.amp.4.lin <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceLin)
gls.amp.1.ratio <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceRatio)
gls.amp.2.ratio <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceRatio)
gls.amp.3.ratio <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.amp.4.ratio <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
#spaceSpher
gls.amp.1.spher <- gls(fdis_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.2.spher <- gls(rich_amp ~ climate_amp + Elevation + Productivity + dr_amp + aa_amp, data=sem_dataset_trans, correlation = spaceSpher)
gls.amp.3.spher <- gls(aa_amp ~ climate_amp + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.amp.4.spher <- gls(dr_amp ~ aa_amp + climate_amp + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
# Anfíbios
AIC(gls.amp.1.exp, gls.amp.1.gaus,gls.amp.1.lin, gls.amp.1.ratio, gls.amp.1.spher) #gls.amp.1.exp
AIC(gls.amp.2.exp, gls.amp.2.gaus, gls.amp.2.ratio, gls.amp.2.spher, gls.amp.2.lin) # gls.amp.2.ratio
AIC(gls.amp.3.exp, gls.amp.3.gaus, gls.amp.3.lin , gls.amp.3.ratio, gls.amp.3.spher) # gls.amp.3.exp
AIC(gls.amp.4.exp, gls.amp.4.gaus, gls.amp.4.ratio, gls.amp.4.spher, gls.amp.4.lin) # gls.amp.4.spher
amp1 <- plot(gls.amp.1.exp, main="gls.amp.1.exp")
amp2 <- plot(gls.amp.2.ratio, main="gls.amp.2.ratio")
amp3 <- plot(gls.amp.3.exp, main="gls.amp.3.exp")
amp4 <- plot(gls.amp.4.spher, main="gls.amp.4.spher")
#plot
plot_grid(amp1,amp2,amp3,amp4, align = "h", rel_widths = c(1, 1),labels = NULL)
# amphibia
anura.psem <- psem(gls.amp.1.spher, gls.amp.2.ratio, gls.amp.3.exp, gls.amp.4.spher)
summary(anura.psem)
# Anfíbios
AIC(gls.amp.1.exp, gls.amp.1.gaus,gls.amp.1.lin, gls.amp.1.ratio, gls.amp.1.spher) #gls.amp.1.exp
AIC(gls.amp.2.exp, gls.amp.2.gaus, gls.amp.2.ratio, gls.amp.2.spher, gls.amp.2.lin)
AIC(gls.amp.3.exp, gls.amp.3.gaus, gls.amp.3.lin , gls.amp.3.ratio, gls.amp.3.spher)
AIC(gls.amp.4.exp, gls.amp.4.gaus, gls.amp.4.ratio, gls.amp.4.spher, gls.amp.4.lin)
# amphibia
anura.psem <- psem(gls.amp.1.exp, gls.amp.2.ratio, gls.amp.3.exp, gls.amp.4.spher)
summary(anura.psem)
# spaceExp
gls.rep.1.exp <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation= spaceExp)
# spaceExp
gls.rep.1.exp <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation= spaceExp)
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans,  correlation= spaceExp)
gls.rep.3.exp <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.rep.4.exp <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation= spaceExp)
gls.rep.1.gaus <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceGaus)
gls.rep.2.gaus <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceGaus)
gls.rep.3.gaus <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.rep.4.gaus <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
# spaceLin
gls.rep.1.lin <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceLin)
# spaceLin
gls.rep.1.lin <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceLin)
gls.rep.2.lin <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceLin)
# spaceRatio
gls.rep.1.ratio <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceRatio)
gls.rep.2.ratio <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceRatio)
gls.rep.3.ratio <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.rep.4.ratio <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
# spaceSpher
gls.rep.1.spher <- gls(fdis_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation=spaceSpher)
gls.rep.2.spher <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = spaceSpher)
gls.rep.3.spher <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.rep.4.spher <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
gls.rep.3.lin <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.rep.4.lin <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans,  correlation= corLin(c(200, 0.1), form =~ V2+V1, nugget=T))###
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans,  correlation= corLin(c(200, 0.1), form =~ V2+V1, nugget=T))###
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans,  correlation= corLin(c(500, 0.1), form =~ V2+V1, nugget=T))###
AIC(gls.rep.1.exp, gls.rep.1.gaus, gls.rep.1.lin, gls.rep.1.ratio, gls.rep.1.spher)
AIC(gls.rep.2.exp, gls.rep.2.ratio, gls.rep.2.gaus, gls.rep.2.lin, gls.rep.2.spher)
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans,  correlation= corLin(c(400, 0.1), form =~ V2+V1, nugget=T))###
AIC(gls.rep.2.exp, gls.rep.2.ratio, gls.rep.2.gaus, gls.rep.2.lin, gls.rep.2.spher)
AIC(gls.rep.3.exp, gls.rep.3.gaus, gls.rep.3.lin, gls.rep.3.ratio, gls.rep.3.spher)
gls.rep.3.lin <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(500, 0.1), form =~ V2+V1, nugget=T))
AIC(gls.rep.3.exp, gls.rep.3.gaus, gls.rep.3.lin, gls.rep.3.ratio, gls.rep.3.spher)
gls.rep.3.exp <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.3.spher <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.3.ratio <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = corRatio(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.3.gaus <- gls(aa_squa ~ climate_squa + Elevation + Productivity,data = sem_dataset_trans, correlation = corGaus(c(500, 0.1), form =~ V2+V1, nugget=T))
AIC(gls.rep.3.exp, gls.rep.3.gaus, gls.rep.3.lin, gls.rep.3.ratio, gls.rep.3.spher)
AIC(gls.rep.4.gaus, gls.rep.4.lin, gls.rep.4.ratio, gls.rep.4.spher,  gls.rep.4.exp)
#Squamata
reptilia.psem <- psem(gls.rep.1.spher, gls.rep.2.spher, gls.rep.3.ratio, gls.rep.4.spher)
summary(reptilia.psem)
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans,  correlation= spaceExp)
gls.rep.2.exp <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans,  correlation= corExp(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.2.gaus <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = corGaus(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.2.lin <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = corLin(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.2.ratio <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = corRatio(c(500, 0.1), form =~ V2+V1, nugget=T))
gls.rep.2.spher <- gls(rich_squa ~ climate_squa + Elevation + Productivity + dr_squa + aa_squa, data=sem_dataset_trans, correlation = corSpher(c(500, 0.1), form =~ V2+V1, nugget=T))
AIC(gls.rep.1.exp, gls.rep.1.gaus, gls.rep.1.lin, gls.rep.1.ratio, gls.rep.1.spher)
AIC(gls.rep.2.exp, gls.rep.2.ratio, gls.rep.2.gaus, gls.rep.2.lin, gls.rep.2.spher)
gls.rep.4.lin <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceLin)
gls.rep.4.ratio <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
gls.rep.4.ratio <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
gls.rep.4.spher <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
gls.rep.4.spher <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
gls.rep.4.gaus <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
gls.rep.4.gaus <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
gls.rep.4.exp <- gls(dr_squa ~ aa_squa + climate_squa + Elevation + Productivity, data = sem_dataset_trans, correlation= spaceExp)
AIC(gls.rep.2.exp, gls.rep.2.ratio, gls.rep.2.gaus, gls.rep.2.lin, gls.rep.2.spher)
AIC(gls.rep.3.exp, gls.rep.3.gaus, gls.rep.3.lin, gls.rep.3.ratio, gls.rep.3.spher)
AIC(gls.rep.4.gaus, gls.rep.4.lin, gls.rep.4.ratio, gls.rep.4.spher,  gls.rep.4.exp)
AIC(gls.rep.4.gaus, gls.rep.4.lin, gls.rep.4.ratio, gls.rep.4.spher,  gls.rep.4.exp) #gls.rep.4.spher
#Squamata
reptilia.psem <- psem(gls.rep.1.spher, gls.rep.2.spher, gls.rep.3.ratio, gls.rep.4.spher)
reptilia.psem
reptilia.psem
summary(reptilia.psem)
gls.bird.1.exp <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans,  correlation = spaceExp)
# spaceLin
gls.bird.1.lin <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceLin)
# spaceGaus
gls.bird.1.gaus <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceGaus)
# spaceRatio
gls.bird.1.ratio <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceRatio)
# spaceRatio
gls.bird.1.ratio <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceRatio)
# spaceSpher
gls.bird.1.spher <- gls(fdis_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds,data=sem_dataset_trans, correlation = spaceSpher)
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceExp)
gls.bird.2.exp <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.gaus <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corGaus(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.lin <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.ratio <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = spaceRatio)
gls.bird.2.spher <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corSpher(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.2.ratio <- gls(rich_birds ~ climate_birds + Elevation + Productivity + dr_birds + aa_birds, data=sem_dataset_trans, correlation = corRatio(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.exp <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.bird.3.exp <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.gaus <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corGaus(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.lin <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.lin <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.lin <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.lin <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(300, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.gaus <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corGaus(c(300, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.gaus <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corGaus(c(300, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.exp <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.ratio <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corRatio(c(300, 0.1), form =~ V2+V1, nugget=T))
gls.bird.3.spher <- gls(aa_birds ~ climate_birds + Elevation + Productivity,data = sem_dataset_trans, correlation = corLin(c(300, 0.1), form =~ V2+V1, nugget=T))
gls.bird.4.exp <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceExp)
gls.bird.4.gaus <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
gls.bird.4.lin <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation =  spaceLin)
gls.bird.4.ratio <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceRatio)
gls.bird.4.spher <- gls(dr_birds ~ aa_birds + climate_birds + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceSpher)
AIC(gls.bird.1.gaus, gls.bird.1.lin, gls.bird.1.ratio, gls.bird.1.spher, gls.bird.1.exp)  #gls.bird.1.ratio
AIC(gls.bird.2.exp, gls.bird.2.gaus, gls.bird.2.ratio, gls.bird.2.spher, gls.bird.2.lin)
gls.bird.2.gaus
gls.bird.4.gaus
AIC(gls.bird.1.gaus, gls.bird.1.lin, gls.bird.1.ratio, gls.bird.1.spher, gls.bird.1.exp)
AIC(gls.bird.2.exp, gls.bird.2.gaus, gls.bird.2.ratio, gls.bird.2.spher, gls.bird.2.lin)
AIC(gls.bird.3.exp, gls.bird.3.gaus, gls.bird.3.ratio, gls.bird.3.spher, gls.bird.3.lin)
AIC(gls.bird.4.exp,gls.bird.4.gaus, gls.bird.4.lin, gls.bird.4.ratio, gls.bird.4.spher)
#Birds
birds.psem <- psem(gls.bird.1.ratio, gls.bird.2.ratio, gls.bird.3.exp, gls.bird.4.spher)
summary(birds.psem)
# spaceExp
gls.mam.1.exp <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation = spaceExp)
# spaceExp
gls.mam.1.exp <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation = corExp(c(100, 0.1), form =~ V2+V1, nugget=T))
# spaceGaus
gls.mam.1.gaus <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=corGaus(c(100, 0.1), form =~ V2+V1, nugget=T))
# spaceLin
gls.mam.1.lin <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation= corLin(c(100, 0.1), form =~ V2+V1, nugget=T))
# spaceRatio
gls.mam.1.ratio <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=corRatio(c(100, 0.1), form =~ V2+V1, nugget=T))
# spaceSpher
gls.mam.1.spher <- gls(fdis_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals,data=sem_dataset_trans, correlation=corSpher(c(100, 0.1), form =~ V2+V1, nugget=T))
gls.mam.2.exp <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceExp)
gls.mam.2.exp <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceExp)
gls.mam.2.gaus <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceGaus)
gls.mam.2.lin <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceLin)
gls.mam.2.ratio <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceRatio)
gls.mam.2.spher <- gls(rich_mammals ~ climate_mammals + Elevation + Productivity + dr_mammals + aa_mammals, data=sem_dataset_trans, correlation = spaceSpher)
gls.mam.3.exp <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.mam.3.exp <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceExp)
gls.mam.3.gaus <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceGaus)
gls.mam.3.lin <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceLin)
gls.mam.3.ratio <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.mam.3.ratio <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceRatio)
gls.mam.3.spher <- gls(aa_mammals ~ climate_mammals + Elevation + Productivity,data = sem_dataset_trans, correlation = spaceSpher)
gls.mam.4.exp <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corExp(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.4.exp <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corExp(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.4.gaus <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
# spaceLin
gls.mam.1.lin <- gls(fd
gls.mam.4.gaus <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = spaceGaus)
gls.mam.4.gaus <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corGaus(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.4.lin <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.4.lin <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.4.ratio <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corLin(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.4.ratio <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corRatio(c(200, 0.1), form =~ V2+V1, nugget=T))
gls.mam.4.spher <- gls(dr_mammals ~ aa_mammals + climate_mammals + Elevation + Productivity, data = sem_dataset_trans, correlation = corSpher(c(200, 0.1), form =~ V2+V1, nugget=T))
AIC(gls.mam.1.exp, gls.mam.1.gaus, gls.mam.1.lin, gls.mam.1.ratio, gls.mam.1.spher)
AIC(gls.mam.2.exp, gls.mam.2.gaus, gls.mam.2.lin, gls.mam.2.ratio, gls.mam.2.spher)
AIC(gls.mam.3.exp, gls.mam.3.gaus, gls.mam.3.lin, gls.mam.3.ratio, gls.mam.3.spher)
AIC(gls.mam.4.exp, gls.mam.4.gaus, gls.mam.4.lin, gls.mam.4.ratio, gls.mam.4.spher)
#Mammals
mammals.psem <- psem(gls.mam.1.spher, gls.mam.2.spher, gls.mam.3.spher, gls.mam.4.spher)
summary(mammals.psem)
#Mammals
mammals.psem <- psem(gls.mam.1.exp, gls.mam.2.spher, gls.mam.3.spher, gls.mam.4.exp)
#Mammals
summary(mammals.psem)
summary(birds.psem)
summary(anura.psem)
summary(reptilia.psem)
summary(birds.psem)
summary(birds.psem)
#Birds
birds.psem <- psem(gls.bird.1.ratio, gls.bird.2.ratio, gls.bird.3.exp, gls.bird.4.spher)
summary(birds.psem)
summary(mammals.psem)
# maps
grid_data <- full_join(grid_ma, sem_dataset,  by="id")
tm_shape(grid_data) +
tm_fill("Elevation", palette = "viridis", style = "cont", title="Richness") +
tm_borders(alpha=.3) +
tm_layout(legend.outside = TRUE,frame = FALSE)
# maps
grid_data <- full_join(grid_ma, sem_dataset_trans,  by="id")
sem_dataset_trans
# maps
grid_data <- full_join(grid_ma, sem_dataset_trans,  by="id")
sem_dataset_trans
colnames(sem_dataset_trans)
resid.anura <- residuals(anura.psem)
#summary(reptilia.psem)
resid.rep <- residuals(reptilia.psem)
#summary(birds.psem)
resid.birds <- residuals(birds.psem)
#summary(mammals.psem)
resid.mammals <- residuals(mammals.psem)
par(mfrow=c(2,2))
moran.amp <- lets.correl(resid.anura, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Repteis
moran.rep <- lets.correl(resid.rep, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Aves
moran.birds <- lets.correl(resid.birds, distan, 12,
equidistant = FALSE,
plot = TRUE)
#Mammals
moran.mammals <- lets.correl(resid.mammals, distan, 12,
equidistant = FALSE,
plot = TRUE)
maprich.rep <- tm_shape(grid_data) +
tm_fill("Productivity", palette = "viridis", style = "cont", title="Richness") +
tm_borders(alpha=.3) +
tm_layout(legend.outside = TRUE,frame = FALSE)
maprich.rep
tm_shape(grid_data) +
tm_fill("Elevation", palette = "viridis", style = "cont", title="Richness") +
tm_borders(alpha=.3) +
tm_layout(legend.outside = TRUE,frame = FALSE)
tm_shape(grid_data) +
tm_fill("climate_amp", palette = "viridis", style = "cont", title="Richness") +
tm_borders(alpha=.3) +
tm_layout(legend.outside = TRUE,frame = FALSE)
